<!doctype html><html lang=en-us><head><meta name=generator content="Hugo 0.69.2"><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge"><meta name=viewport content="width=device-width,initial-scale=1"><title>The Origin-Destination Matrix | The Flow | L M</title><meta name=description content="The OD matrix is a very useful tool to analyze the supply and demand"><meta name=author content="L M"><meta property="og:title" content="The Origin-Destination Matrix"><meta property="og:description" content="The OD matrix is a very useful tool to analyze the supply and demand"><meta property="og:type" content="article"><meta property="og:url" content="/road-freight/basics/origin-destination-matrix/"><link rel=canonical href=/road-freight/basics/origin-destination-matrix/><link rel="shortcut icon" type=image/png href=/logos/logo-square.png><link rel=stylesheet href=/css/bulma.css><link rel=stylesheet href=/css/bulma-divider.min.css><link rel=stylesheet href=/assets/css/bulma-ribbon.min.css><link rel=stylesheet href=/assets/css/tooltip.css><link rel=stylesheet href=https://jenil.github.io/bulmaswatch/litera/bulmaswatch.min.css><link rel=stylesheet href=/css/custom.css><link rel=stylesheet href=/css/blog-post.css><link rel=stylesheet href=/css/code-highlighting/dark.css><link rel=stylesheet href=/css/custom.css><link rel=stylesheet href=https://unpkg.com/applause-button/dist/applause-button.css><script>MathJax={tex:{inlineMath:[['$','$'],['\\(','\\)']],displayMath:[['$$','$$'],['\\[','\\]']],tags:'ams',processEscapes:true,processEnvironments:true},options:{skipHtmlTags:['script','noscript','style','textarea','pre']},svg:{fontCache:'global'}};window.addEventListener('load',(event)=>{document.querySelectorAll("mjx-container").forEach(function(x){x.parentElement.classList+='has-jax'})});</script><script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script><script type=text/javascript id=MathJax-script async src=https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js></script><script src=https://cdn.jsdelivr.net/npm/mermaid/dist/mermaid.min.js></script><script>mermaid.initialize({startOnLoad:true});</script><script src=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/js/all.min.js integrity="sha256-KzZiKy0DWYsnwMF+X1DvQngQ2/FxF7MF3Ff72XcpuPs=" crossorigin=anonymous></script><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.13.0/css/all.min.css integrity="sha256-h20CPZ0QyXlBuAw7A+KluUYx/3pK+c7lYEpqLTlxjYQ=" crossorigin=anonymous></head><body><header><nav class="navbar is-transparent"><div class=navbar-brand><a class=navbar-item href=/><img src=/logos/logo-square.png alt="The Flow" height=28 style=margin-right:.5em> The Flow</a><div class="navbar-burger burger" style=color:#000 data-target=navMenu><span></span><span></span><span></span></div></div><div class=navbar-menu id=navMenu><div class=navbar-start><div class="navbar-item has-dropdown is-hoverable"><a href=/projects class=navbar-link>Chapters</a><div class=navbar-dropdown><a href=/road-freight/ class=navbar-item>Road Freight ðŸšš</a></div></div></div><span class=navbar-burger><span></span><span></span><span></span></span><div class=navbar-end><div class=navbar-item><a class=navbar-item href=/tags/><i class="fas fa-tags"></i></a><a class=navbar-item href=/graph><i class="fas fa-project-diagram"></i></a><a class=navbar-item target=blank href=https://github.com/emptymalei><span class=icon><i class="fab fa-github"></i></span></a></div></div></div></nav><script>document.addEventListener('DOMContentLoaded',()=>{const $navbarBurgers=Array.prototype.slice.call(document.querySelectorAll('.navbar-burger'),0);if($navbarBurgers.length>0){$navbarBurgers.forEach(el=>{el.addEventListener('click',()=>{const target=el.dataset.target;const $target=document.getElementById(target);el.classList.toggle('is-active');$target.classList.toggle('is-active');});});}});</script></header><main><div class=container itemscope itemtype=http://schema.org/BlogPosting><meta itemprop=name content="The Origin-Destination Matrix"><meta itemprop=description content="The OD matrix is a very useful tool to analyze the supply and demand"><meta itemprop=wordCount content="824"><meta itemprop=keywords content="Road Freight,Economics,"><section class=section><div class=container><article class=post><header class=post-header><nav class="breadcrumb has-succeeds-separator is-small" aria-label=breadcrumbs><ul><li><a href=/>The Flow</a></li><li><a href=/road-freight/>Road Freight ðŸšš</a></li><li><a href=/road-freight/basics/>Basics</a></li><li class=active><a href=/road-freight/basics/origin-destination-matrix/>The Origin-Destination Matrix</a></li></ul></nav><h1 class="post-title has-text-centered is-size-1" itemprop="name headline">The Origin-Destination Matrix</h1><h2 class="title is-6 has-text-centered"><i class="fas fa-tags" style=margin-right:.5em></i><a href=/tags/road-freight><span class="tag is-warning is-small is-light">#Road Freight</span></a>
<a href=/tags/economics><span class="tag is-warning is-small is-light">#Economics</span></a></h2></header><div class=columns><div class="column is-8"><div class=is-divider data-content=ARTICLE></div><div class="content blog-post section" itemprop=articleBody><p>In this section, we will be looking into the so-called origin-destination matrix, or the OD matrix. The OD matrix tells us the trip distribution between a pair of locations $(p, q)$. There are many representations of the OD matrix. It can be represented using a matrix, a network, or the generating process behind it.</p><article class="message is-info is-light"><div class=message-header><p>Notations</p></div><div class=message-body><p>In this page, we will use the following notations.</p><ol><li>$P$: a set of origins;</li><li>$p$: an element of $P$, i.e., an origin;</li><li>$Q$: a set of destinations;</li><li>$q$: an element of $Q$, i.e., a destination;</li><li>$o_p$: total flow out of the origin $p$;</li><li>$d_q$: total flow into destination $q$;</li><li>$g_{pq}$: flow between origin $p$ and destination $q$.</li><li>$\{g_{pq}\}$: the travel demand.</li></ol></div></article><h2 id=the-matrix>The Matrix</h2><p>The origin-destination matrix describes ${g_{pq}}$ for origin-destination pairs $pq\in P\bigotimes Q$.</p><p>We show an example using the international road freight data from Eurostats.<sup id=fnref:1><a href=#fn:1 class=footnote-ref role=doc-noteref>1</a></sup> The are many different representations of the origin-destination matrix. The data can be represented using tabular data. On the other hand, it is easier to interpret if we introduce some visualization elements. For example, we visualize the matrix using a heatmap where we color code the amount of goods transported in unit of million-tonne-kilometer.</p><figure><img src=../assets/origin-destination-matrix/europe-international-goods-matrix-plot.png alt="Visualization of goods loaded unloaded in Europe. The gray cells in the charts indicates missing data."><figcaption><p>Visualization of goods loaded unloaded in Europe. The gray cells in the charts indicates missing data.</p></figcaption></figure><p>Alternatively, we can visualize this matrix using networks.</p><figure><img src=../assets/origin-destination-matrix/europe-international-goods-network-vis.png alt="Visualization of goods loaded unloaded in Europe using networks. Some countries are less connected."><figcaption><p>Visualization of goods loaded unloaded in Europe using networks. Some countries are less connected.</p></figcaption></figure><p>There are other visualizations of networks such as arc plots and circle plots. In the end, visualizations are just some of the representations of the matrix. A much more powerful representation is a way to describe the generating process of the origin-destination matrix. For example, we could represent the underlying generating process with a function. The function itself, could as well be a neural network if desired.</p><h2 id=a-generating-process-behind-the-origin-destination-matrix>A Generating Process behind the Origin-Destination Matrix</h2><p>Simply describing the data is not so satisfying. What is more powerful is to find or construct a simple model to describe the underlying generating process so it can be used to find causalities and predict the future. One of such models is the gravity model.</p><p>The gravity model is a simple distribution model where we assume the distribution is proportional to the two masses: the flow out of the origin and the flow into the destination. In this section, we will follow A. Peterson to demonstrate the basic ideas of this model<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>. The flow between origin $p$ and destination $q$ is assumed to be proportional to the multiplication of them, as the gravitational force between to massive objects,</p><p>$$
g_{pq} = k_{pq} o_p d_q f(\pi_{pq}),
$$</p><p>where $\pi_{pq}$ is the travel impedance. We have</p><p>$$
o_p = \sum_q g_{pq}
$$</p><p>and</p><p>$$
d_q = \sum_p g_{pq}.
$$</p><p>The deterrence function $f(\pi_{pq})$ can have many different forms as long as it captures the factors of friction:</p><ul><li>polynomial: $\pi_{pq}^{-\beta}$,</li><li>exponential: $e^{-\beta \pi_{pq}}$.</li></ul><p>The coefficient $k_{pq}$ is also taking care of the fact that the dependency on the masses $o_p$ and $d_q$ and the deterrence can be different for different lanes.</p><p>Given the fact that the total flow out of $p$ is</p><p>$$
o_p = \sum_q g_{pq} = o_p\sum_q k_{pq} d_q f(\pi_{pq}),
$$</p><p>we thus derive a simple identity</p><p>$$
\sum_q k_{pq} d_q f(\pi_{pq}) = 1.
$$</p><h2 id=modal-split>Modal Split</h2><p>The split of the loads between origin and destination can also be assigned to different modes, i.e., partitioning of the flow based on travel modes $g^k_{pq}$. In this section, we review a method called multinomial logit model introduced in A. Peterson (2007)<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup>. We use the probability of modes $p_k$ to describe the split, i.e., $g_{pqk} = g_{pq}p_k$.</p><p>To partition the flow, a utility function $u_k$ of each mode $k$ is introduced. The utility function considers:</p><ul><li>Some attributes denoted by $h$, $h$ can be walking time, transport time, etc. All the attributes form a set $H$ where $h\in H$;</li><li>Travel mode $k$;</li><li>The measured value of attribute $h$ for travel mode $k$: $x_{hk}$;</li><li>Weighting parameter $\alpha_h$.</li></ul><p>The utility function has two major parts. The part of utility that can be modeled</p><p>$$
v_k = \sum_h \alpha_h x_{hk},
$$</p><p>as well as a part from the random effects. The actual utility may have some random effects $\epsilon_k$,</p><p>$$
u_k = v_k + \epsilon_k.
$$</p><p>The multinomial logit model assumes the probability of the mode $k$ to be</p><p>$$
p_k = \frac{e^{\mu u_k}}{ \sum_k e^{\mu u_k} } = \frac{e^{\mu v_k} e^{\mu \epsilon_k}}{ \sum_k e^{\mu u_k} e^{\mu \epsilon_k} }.
$$</p><p>The non-linearity leads to some problems. Different combination of modes leads to contradictory results.<sup id=fnref:2><a href=#fn:2 class=footnote-ref role=doc-noteref>2</a></sup> One solution to such problems is to come up with a fixed hierarchy model.</p><h2 id=references>References</h2><ol><li><a href=https://en.wikipedia.org/wiki/Trip_distribution>Trip distribution @ Wikipedia</a></li></ol><section class=footnotes role=doc-endnotes><hr><ol><li id=fn:1 role=doc-endnote><p><a href=https://ec.europa.eu/eurostat/web/main/home>Eurostats</a> is a good place to find <a href=https://ec.europa.eu/eurostat/data/database>datasets about Europe</a>. For example, the provide a dataset on <a href="https://ec.europa.eu/eurostat/estat-navtree-portlet-prod/BulkDownloadListing?file=data/road_go_ia7lgtt.tsv.gz">goods loaded in reporting country</a> with <a href=https://ec.europa.eu/eurostat/cache/metadata/en/road_go_esms.htm>illustrations of the data here</a>. <a href=#fnref:1 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li><li id=fn:2 role=doc-endnote><p>Peterson, A. (2007). The Originâ€“Destination Matrix Estimation Problem â€” Analysis and Computations. In Journal of Scientific and Industrial Research (Vol. 67). <a href=#fnref:2 class=footnote-backref role=doc-backlink>&#8617;&#xfe0e;</a></p></li></ol></section></div><p><div class="has-text-right is-size-7"><span class=icon><i class="fas fa-pencil-alt"></i></span>Published: <time datetime=0001-01-01T00:00:00+00:00>0001-01-01</time>
by <span itemprop=author>L M</span>;</div></p><div class=is-divider></div><nav class="pagination is-centered" role=navigation aria-label=pagination><a href="/road-freight/basics/freight-modes/?ref=footer" class=pagination-previous>Â« Modes of Freight</a></nav></div><div class="column is-4"><div class=is-divider data-content="Cite Me"></div><div class="box is-size-7 has-text-white has-background-black"><article class=media style=overflow-x:scroll><div class=media-content><div class=content><p>L M
(0001). 'The Origin-Destination Matrix', The Flow, 01 April. Available at: /road-freight/basics/origin-destination-matrix/.</p></div></div></article></div><style>#TableOfContents>ul{list-style-type:lower-greek;padding-left:0}#TableOfContents>ul>li ul{list-style-type:none;padding-left:1em}</style><div class=is-divider data-content=ToC></div><div class="box is-size-7"><article class=media><div class=media-content><div class=content><details><summary>Table of Contents</summary><div><div><nav id=TableOfContents><ul><li><a href=#the-matrix>The Matrix</a></li><li><a href=#a-generating-process-behind-the-origin-destination-matrix>A Generating Process behind the Origin-Destination Matrix</a></li><li><a href=#modal-split>Modal Split</a></li><li><a href=#references>References</a></li></ul></nav></div></div></details></div></div></article></div><script>const el=document.querySelector('details summary')
el.onclick=()=>{(function(l,o,a,d,e,r){e=o.createElement(a),r=o.getElementsByTagName(a)[0];e.async=1;e.src=d;r.parentNode.insertBefore(e,r)})(window,document,'script','/js/smoothscroll.js');el.onclick=null}
document.querySelectorAll('#TableOfContents a').forEach(link=>{link.addEventListener('click',()=>{document.querySelector(link.href.slice(link.href.indexOf('#'))).scrollIntoView({behavior:'smooth'})})})</script><div class=is-divider data-content=CONNECTUME></div><div class="box is-size-7"><article class=media><div class=media-content style=width:100%><div class=content><p><strong>Current Ref:</strong><br><ul><li style=list-style:none><div style=overflow-x:scroll>road-freight/basics/origin-destination-matrix.md</div></li></ul></p></div></div></article></div><div id=comments class=is-divider data-content=COMMENTS></div><script src=https://utteranc.es/client.js repo=emptymalei/theflow issue-term=pathname theme=github-light crossorigin=anonymous async></script></div></div></article></div></section></div><div class=navtools><a class="button is-primary is-light is-outlined" alt="Edit this page" href=https://github.com/emptymalei/theflow/edit/master/content/road-freight/basics/origin-destination-matrix.md target=blank style=position:fixed;bottom:20px;right:10px;border-radius:9999px;width:35px;height:35px><i class="fas fa-pencil-alt"></i></a><a class="button is-primary is-light is-outlined" href=#comments alt=Comments style=position:fixed;bottom:60px;right:10px;border-radius:9999px;width:35px;height:35px><i class="far fa-comments"></i></a><a class="button is-primary is-light is-outlined" data-lyket-type=updown data-lyket-id=origin-destination-matrix data-lyket-namespace="The Flow" data-lyket-template=reddit style=width:35px;height:35px;position:fixed;bottom:120px;right:10px;border-radius:9999px></a></div></main><footer><footer class=footer><div class=container><div class="content has-text-centered"><p>Created and maintained by <a href>L M</a>.
Acknowledgement: <a href=https://gohugo.io/>Hugo</a>,
<a href=https://themes.gohugo.io/bulma/>Bulma</a>, <a href=https://kausalflow.com>KausalFlow</a>.
<strong>love</strong>.<br><a class=tag href=/index.xml>Feed</a>
<a class=tag href=/data.json>JSON Data</a></p></div></div></footer><script src=https://unpkg.com/applause-button/dist/applause-button.js></script></footer><script src="https://unpkg.com/@lyket/widget@latest/dist/lyket.js?apiKey=4df20b7e32f469fed5dc53f5ab39d8&disableSessionId"></script><script async type=text/javascript src=/js/bulma.js></script></body></html>